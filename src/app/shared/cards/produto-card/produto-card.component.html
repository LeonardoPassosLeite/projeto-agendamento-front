<mat-card class="product-card">
    <ng-container *ngIf="!product.disponibilidade">
        <div class="sold-out-ribbon">ESGOTADO</div>
    </ng-container>
    <div class="image-container">
        <img mat-card-image [src]="product.imageUrl" alt="{{ product.nome }}">
        <ng-container *ngIf="isEditing">
            <div class="upload-placeholder" (click)="fileInput.click()">
                <input type="file" #fileInput (change)="onFileSelected($event)" hidden>
                <div class="upload-icon">
                    <mat-icon>cloud_upload</mat-icon>
                    <p>Clique para adicionar uma imagem</p>
                </div>
            </div>
        </ng-container>
    </div>

    <mat-card-content class="fs-12 bold">
        <div class="d-flex py-18">
            <div class="d-flex gap-10">
                <ng-container *ngIf="isEditing; else showYear">
                    <app-input inputId="productYear" [(ngModel)]="product.ano" labelText="Ano"></app-input>
                </ng-container>
                <ng-template #showYear>
                    <div class="year-ribbon">{{ product.ano }}</div>
                </ng-template>

                <ng-container *ngIf="isEditing; else showName">
                    <app-input inputId="productName" [(ngModel)]="product.nome" labelText="Nome do Produto"></app-input>
                </ng-container>
                <ng-template #showName>
                    <div class="fs-18">{{ product.nome }}</div>
                </ng-template>
            </div>
        </div>

        <div class="d-grid gap-10">
            <div class="brand-location">
                <ng-container *ngIf="isEditing; else showBrand">
                    <app-dropdown selectId="productMark" [(ngModel)]="product.marca" name="productMark"
                        labelText="Marca" [options]="markOptions"></app-dropdown>
                </ng-container>
                <ng-template #showBrand>
                    <div class="py-18 fs-16">{{ product.marca }}</div>
                </ng-template>

                <ng-container *ngIf="isEditing; else showLocation">
                    <input matInput placeholder="Localidade" [(ngModel)]="product.localidade"
                        class="edit-input location-input">
                </ng-container>
                <ng-template #showLocation>
                    <div class="d-flex">
                        <mat-icon>location_on</mat-icon>
                        <span>{{ product.localidade }}</span>
                    </div>
                </ng-template>
            </div>

            <div class="grid-column-2">
                <ng-container *ngIf="isEditing; else showKm">
                    <app-number-input inputId="productQuilometragem" [(ngModel)]="product.quilometragem"
                        labelText="Quilometragem">
                    </app-number-input>
                </ng-container>
                <ng-template #showKm>
                    <div class="d-flex py-18">
                        <mat-icon>speed</mat-icon>
                        <span>{{ product.quilometragem }} KM</span>
                    </div>
                </ng-template>

                <ng-container *ngIf="isEditing; else showPrice">
                    <input matInput type="number" placeholder="PreÃ§o" [(ngModel)]="product.price"
                        class="edit-input price-input">
                </ng-container>
                <ng-template #showPrice>
                    <div>
                        <div class="fs-16">{{ product.price | currency:'BRL' }}</div>
                    </div>
                </ng-template>
            </div>

            <div class="empty-space"></div>
        </div>
    </mat-card-content>

    <mat-card-actions class="flex-start">
        <ng-container *ngIf="isEditing; else showButtons">
            <button mat-raised-button color="primary" (click)="saveProduct()">Salvar</button>
        </ng-container>
        <ng-template #showButtons>
            <button mat-raised-button color="primary" (click)="addToCustomer(product)"
                [disabled]="product.disponibilidade === false">
                <mat-icon>add_shopping_cart</mat-icon>
                Selecionar Cliente
            </button>
            <button mat-icon-button (click)="edit()">
                <mat-icon>edit</mat-icon>
            </button>
            <div class="margin-left"> <button mat-icon-button>
                    <mat-icon>visibility</mat-icon>
                </button>
            </div>
        </ng-template>
    </mat-card-actions>
</mat-card>